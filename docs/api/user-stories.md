## 문서 정보
- 버전 : 1.0.0
- 작성일 : 2025-10-28
- 기준 문서 : requirements.md v1.0.0

--- 

## 상품 관리

### US-01: 상품 목록 조회

**사용자 스토리**  
고객으로서, 판매 중인 상품 목록을 확인하고 싶습니다. 원하는 상품을 찾아 구매를 검토할 수 있도록 하기 위함입니다.

**인수 조건**
- 상품 목록 조회 API 호출 시 등록된 상품이 반환되어야 함
- 각 상품은 상품ID, 상품명, 가격, 카테고리 정보를 포함해야 함
- 페이징 처리가 적용되어야 함 (기본 20개씩)
- 품절 상품은 품절 여부가 명시되어야 함
- 각 상품은 목록에 노출 여부에 따라 조회 여부가 결정되어야 함

---

### US-02: 상품 상세 조회

**사용자 스토리**  
고객으로서, 특정 상품의 상세 정보를 확인하고 싶습니다. 구매 결정을 위해 가격, 재고, 설명 등을 자세히 알고 싶기 때문입니다.

**인수 조건**
- 상품ID로 상품 상세 조회 시 해당 상품의 모든 정보가 반환되어야 함
- 상품명, 가격, 카테고리, 설명, 이미지 URL이 포함되어야 함
- 현재 재고 수량이 실시간으로 표시되어야 함
- 존재하지 않는 상품 조회 시 적절한 에러 메시지 반환

---

### US-03: 재고 실시간 확인

**사용자 스토리**  
고객으로서, 상품의 현재 재고를 실시간으로 확인하고 싶습니다. 품절된 상품을 주문하는 것을 방지하기 위함입니다.

**인수 조건**
- 상품 조회 시 현재 재고 수량이 정확히 표시되어야 함
- 재고가 0인 경우 "품절" 상태로 표시되어야 함
- 재고 수량은 주문 완료 시 즉시 반영되어야 함
- 다른 사용자의 주문으로 재고가 변경되면 새로고침 시 최신 재고가 조회되어야 함

---

### US-04: 인기 상품 통계 조회

**사용자 스토리**  
고객으로서, 최근 인기 있는 상품을 확인하고 싶습니다. 많은 사람들이 구매하는 제품을 참고하여 구매 결정을 하고 싶기 때문입니다.

**인수 조건**
- 최근 3일간 판매량 기준 Top 5 상품이 조회되어야 함
- 순위, 상품명, 판매 수량이 포함되어야 함
- 판매량이 동일한 경우 상품명 오름차순으로 우선순위를 가져야 함
- 판매 내역이 없는 경우 빈 목록 반환

---

## 장바구니

### US-05: 장바구니에 상품 추가

**사용자 스토리**  
고객으로서, 구매를 원하는 상품을 장바구니에 담고 싶습니다. 여러 상품을 모아서 한 번에 주문하기 위함입니다.

**인수 조건**
- 상품ID와 수량을 지정하여 장바구니에 추가할 수 있어야 함
- 수량은 1 이상의 정수여야 함
- 이미 장바구니에 있는 상품 추가 시 수량이 합산되어야 함
- 존재하지 않는 상품 추가 시 에러 반환
- 재고보다 많은 수량 추가 시 경고 메시지 표시하며 추가되지 않음

---

### US-06: 장바구니 조회

**사용자 스토리**  
고객으로서, 장바구니에 담긴 상품 목록을 확인하고 싶습니다. 주문 전에 상품과 금액을 최종 확인하기 위함입니다.

**인수 조건**
- 장바구니에 담긴 모든 상품이 조회되어야 함
- 각 상품의 현재 가격, 수량, 소계가 표시되어야 함
- 각 상품이 품절이면 표시되어야 함
- 품절된 상품은 별도 표시되어야 함
- 전체 총액이 계산되어 표시되어야 함

---

### US-07: 장바구니 수량 변경

**사용자 스토리**  
고객으로서, 장바구니에 담긴 상품의 수량을 변경하고 싶습니다. 구매 수량을 조정하기 위함입니다.

**인수 조건**
- 장바구니 상품의 수량을 증가 또는 감소시킬 수 있어야 함
- 수량을 1 미만으로 변경할 수 없어야 함
- 변경 후 즉시 총액이 재계산되어야 함

---

### US-08: 장바구니 상품 삭제

**사용자 스토리**  
고객으로서, 장바구니에서 특정 상품을 제거하고 싶습니다. 구매하지 않기로 결정한 상품을 정리하기 위함입니다.

**인수 조건**
- 장바구니에서 특정 상품을 선택하여 삭제할 수 있어야 함
- 삭제 후 장바구니 목록에서 즉시 제거되어야 함
- 삭제 후 총액이 재계산되어야 함

---

## 주문 및 결제

### US-09: 주문 생성

**사용자 스토리**  
고객으로서, 장바구니의 상품들로 주문을 생성하고 싶습니다. 원하는 상품을 구매하기 위함입니다.

**인수 조건**
- 장바구니에 담긴 모든 상품이 주문에 포함되어야 함
- 주문 생성 시 각 상품의 재고가 확인되어야 함
- 재고 부족 상품이 있는 경우 주문 생성이 실패해야 함
- 재고 부족 시 어떤 상품이 부족한지 안내 메시지 반환
- 주문 생성 성공 시 고유한 주문번호가 발급되어야 함
- 주문 생성 즉시 재고가 차감되어야 함

---

### US-10: 쿠폰 적용 주문

**사용자 스토리**  
고객으로서, 주문 시 보유한 쿠폰을 사용하여 할인받고 싶습니다. 더 저렴하게 구매하기 위함입니다.

**인수 조건**
- 주문 생성 시 사용할 쿠폰ID를 지정할 수 있어야 함
- 쿠폰의 유효성이 검증되어야 함 (유효기간, 사용여부, 최소주문금액)
- 쿠폰이 유효하지 않은 경우 구체적인 사유와 함께 실패 처리
- 쿠폰 할인이 적용된 최종 금액이 계산되어야 함
- 정률 할인의 경우 할인 금액이 정확히 계산되어야 함

---

### US-11: 포인트로 결제

**사용자 스토리**  
고객으로서, 충전한 포인트로 주문을 결제하고 싶습니다. 간편하게 결제를 완료하기 위함입니다.

**인수 조건**
- 주문 금액만큼 잔액이 차감되어야 함
- 잔액이 부족한 경우 결제가 실패해야 함
- 부족 금액이 안내 메시지에 포함되어야 함
- 결제 성공 시 주문 상태가 "결제 완료"로 변경되어야 함
- 결제 완료 시 사용된 쿠폰은 "사용 완료" 상태로 변경되어야 함
- 결제 실패 시 차감된 재고가 복구되어야 함

---

### US-12: 주문 내역 조회

**사용자 스토리**  
고객으로서, 내가 주문한 내역을 확인하고 싶습니다. 과거 주문을 조회하고 관리하기 위함입니다.

**인수 조건**
- 자신의 모든 주문 내역이 조회되어야 함
- 주문번호, 주문일시, 총 금액, 결제 금액이 표시되어야 함
- 최신 주문이 먼저 표시되어야 함
- 주문이 없는 경우 빈 목록 반환

---

### US-13: 주문 상세 조회

**사용자 스토리**  
고객으로서, 특정 주문의 상세 정보를 확인하고 싶습니다. 주문한 상품과 금액을 자세히 보기 위함입니다.

**인수 조건**
- 주문번호로 주문 상세 정보가 조회되어야 함
- 주문 상품 목록 (상품명, 가격, 수량, 소계)이 표시되어야 함
- 적용된 쿠폰 정보 (쿠폰명, 할인금액)가 표시되어야 함
- 총 상품 금액, 할인 금액, 최종 결제 금액이 표시되어야 함
- 다른 사용자의 주문은 조회할 수 없어야 함

---

## 쿠폰 시스템

### US-14: 선착순 쿠폰 발급

**사용자 스토리**  
고객으로서, 선착순 쿠폰을 발급받고 싶습니다. 한정된 혜택을 먼저 받기 위함입니다.

**인수 조건**
- 쿠폰 발급 요청 시 발급 가능 수량을 확인해야 함
- 발급 가능 수량이 남아있는 경우에만 발급되어야 함
- 수량 초과 시 "발급 마감" 안내 메시지 반환
- 이미 발급받은 쿠폰은 재발급되지 않아야 함
- 재발급 시도 시 "이미 발급받은 쿠폰" 안내 메시지 반환
- 발급 성공 시 발급 일시가 기록되어야 함

---

### US-15: 내 쿠폰 조회

**사용자 스토리**  
고객으로서, 내가 보유한 쿠폰 목록을 확인하고 싶습니다. 사용 가능한 쿠폰을 파악하여 주문 시 활용하기 위함입니다.

**인수 조건**
- 발급받은 모든 쿠폰이 조회되어야 함
- 각 쿠폰의 상태 (사용 가능, 사용 완료, 만료)가 표시되어야 함
- 쿠폰명, 할인 정보, 최소 주문 금액, 유효기간이 표시되어야 함
- 사용 가능한 쿠폰이 먼저 표시되어야 함
- 유효기간이 지난 쿠폰은 "만료" 상태로 표시

---

## 잔액 관리

### US-16: 포인트 충전

**사용자 스토리**  
고객으로서, 결제에 사용할 포인트를 충전하고 싶습니다. 주문 시 포인트로 결제하기 위함입니다.

**인수 조건**
- 충전 금액을 입력하여 포인트로 충전할 수 있어야 함
- 충전 가능 최소 금액은 1,000원이어야 함
- 충전 성공 시 잔액이 즉시 증가해야 함
- 충전 내역이 기록되어야 함 (충전일시, 충전금액, 충전 후 포인트)

---

### US-17: 포인트 조회

**사용자 스토리**  
고객으로서, 현재 내 포인트를 확인하고 싶습니다. 주문 전에 포인트가 충분한지 확인하기 위함입니다.

**인수 조건**
- 현재 포인트가 정확히 조회되어야 함
- 포인트는 실시간으로 반영되어야 함

---

### US-18: 잔액 사용 이력 조회

**사용자 스토리**  
고객으로서, 포인트 충전 및 사용 내역을 확인하고 싶습니다. 포인트 변동 내역을 추적하기 위함입니다.

**인수 조건**
- 모든 포인트 충전 및 사용 내역이 조회되어야 함
- 각 내역은 일시, 구분(충전/사용), 금액, 변동 후 포인트을 포함해야 함
- 최신 내역이 먼저 표시되어야 함
- 사용 내역의 경우 연결된 주문번호가 표시되어야 함

---

## 데이터 연동

### US-19: 주문 데이터 자동 전송

**사용자 스토리**  
시스템 운영자로서, 주문 완료 시 외부 시스템으로 주문 데이터가 자동으로 전송되길 원합니다. 물류 및 ERP 시스템과 연동하기 위함입니다.

**인수 조건**
- 주문 결제 완료 시 자동으로 외부 전송이 시도되어야 함
- 전송 데이터에는 주문번호, 고객정보, 상품 목록, 결제 금액, 주문일시가 포함되어야 함
- 전송 성공 시 전송 이력이 기록되어야 함
- 전송 실패 시에도 주문은 정상 완료 상태를 유지해야 함

---

### US-20: 전송 실패 자동 재시도

**사용자 스토리**  
시스템 운영자로서, 외부 전송 실패 시 자동으로 재시도되길 원합니다. 일시적 네트워크 장애로 인한 데이터 유실을 방지하기 위함입니다.

**인수 조건**
- 전송 실패 시 자동으로 재시도되어야 함
- 최대 3회까지 재시도되어야 함
- 재시도 간격은 1분, 5분, 15분이어야 함
- 각 재시도 시도가 이력에 기록되어야 함

---

## 용어집

- **쿠폰 발급**: 고객에게 쿠폰을 제공하여 사용 가능한 상태로 만드는 것
- **쿠폰 사용**: 주문 시 쿠폰을 적용하여 할인을 받는 것
- **포인트**: 고객이 미리 충전하여 결제에 사용할 수 있는 금액
- **재고 차감**: 주문 생성 시 상품의 재고 수량을 줄이는 것
- **외부 전송**: 주문 데이터를 외부 시스템(물류, ERP 등)으로 전달하는 것
- **인기 상품**: 최근 3일간 판매량이 많은 상품
- **선착순**: 요청 순서대로 처리하되, 한정 수량이 소진되면 종료되는 방식