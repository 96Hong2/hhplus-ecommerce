## 문서 정보
- 버전 : 1.0.0
- 작성일 : 2025-10-28
- 프로젝트명 : ecommerce project

## 프로젝트 개요

### 목적
상품 관리, 주문 관리, 결제, 쿠폰 마케팅, 외부 시스템 연동을 제공하는 이커머스 시스템 구축

### 범위
- 상품 관리 (조회, 재고 관리, 인기 상품 통계)
- 장바구니 기능
- 주문 및 결제 처리
- 쿠폰 발급 및 할인 적용
- 포인트 관리
- 외부 시스템 데이터 연동

----

## 사용자 역할 및 권한

### 고객
- 상품 조회 및 검색
- 장바구니 관리
- 주문 생성 및 조회
- 쿠폰 발급 및 사용
- 포인트 충전 및 조회

### 관리자
- 상품 등록, 수정, 삭제
- 재고 관리
- 주문 조회 및 상태 관리
- 쿠폰 생성 및 관리
- 인기 상품 통계 조회

---

## 기능적 요구사항 (Functional Requirements)
###  FR-01: 상품 관리
#### FR-01.1: 상품 조회
  - 상품 ID로 상품 상세 정보를 조회할 수 있어야 함
  - 조회 정보 : 상품명, 가격, 카테고리, 설명, 이미지 URL
  - 상품 목록 조회 시 페이징 지원 필요 
#### FR-01.2: 상품 등록 (관리자)
  - 관리자는 새로운 상품을 등록할 수 있어야 함
  - 필수 입력 항목: 상품명, 가격, 초기 재고 수량, 카테고리 
#### FR-01.3: 상품 수정 (관리자)
  - 관리자는 등록된 상품 정보를 수정할 수 있어야 함
  - 수정 가능 항목: 상품명, 가격, 설명, 카테고리
#### FR-01.4: 상품 삭제 (관리자)
  - 관리자는 상품을 삭제할 수 있어야 함
  - 주문 내역이 있는 상품은 논리 삭제 처리
#### FR-01.5: 재고 실시간 확인
  - 고객은 상품의 현재 재고 수량을 실시간으로 확인할 수 있어야 함
  - 재고 0 이하 시 "품절" 표시
#### FR-01.6: 재고 수량 조정 (관리자)
  - 관리자는 상품 재고를 증감할 수 있어야 함
#### FR-01.7: 인기 상품 통계
  - 시스템은 최근 3일간 판매량 기준 Top 5 인기 상품을 제공해야 함
  - 통계 조회는 누구나 가능

### FR-02: 장바구니
#### FR-02.1: 장바구니 추가
  - 고객은 상품을 장바구니에 추가할 수 있어야 함 
  - 추가 시 수량, 옵션 지정 필수. 기본수량은 1
  - 이미 존재하는 상품인 경우 수량 합산
#### FR-02.2: 장바구니 조회
  - 고객은 자신의 장바구니 목록을 조회할 수 있어야 함
  - 각 상품의 현재 가격, 품절 여부, 담아둔 수량 표시
  - 총 금액 계산 제공
#### FR-02.3: 장바구니 수량 수정
  - 고객은 장바구니 상품의 수량을 변경할 수 있어야 함
  - 수량 1보다 적게 설정할 수 없음
#### FR-02.4: 장바구니 상품 삭제
  - 고객은 장바구니에서 특정 상품을 삭제할 수 있어야 함
#### FR-02.5: 장바구니 전체 삭제
  - 고객은 장바구니를 전체 삭제할 수 있어야 함

### FR-03: 주문 및 결제
#### FR-03.1: 주문 생성
  - 고객은 장바구니 기반으로 주문을 생성할 수 있어야 함
  - 주문 생성 시 재고 확인, 재고 부족 시 주문 생성 실패 및 안내 메시지 반환
#### FR-03.2: 재고 차감
  - 주문 생성 시 해당 상품의 재고가 자동으로 차감되어야 함
#### FR-03.3: 포인트 기반 결제
  - 고객의 포인트로 주문 금액을 결제할 수 있어야 함
  - 포인트 부족 시 결제 실패 처리
  - 결제 성공 시 포인트 차감
#### FR-03.4: 쿠폰 할인 적용
  - 주문 시 보유한 쿠폰을 적용하여 할인받을 수 있어야 함
  - 쿠폰은 한 주문에 하나만 적용 가능
  - 할인 적용 후 최종 금액으로 결제 진행
#### FR-03.5: 주문 내역 조회
  - 고객은 자신의 주문 내역을 조회할 수 있어야 함
  - 조회 정보: 주문번호, 주문일시, 주문 상품 목록, 총 금액, 할인 금액, 최종 결제 금액
#### FR-03.6: 주문 상세 조회
  - 고객은 특정 주문의 상세 정보를 조회할 수 있어야 함
  - 적용된 쿠폰 정보, 상품별 결제 당시 가격 및 수량 포함
  
### FR-04: 쿠폰 시스템
#### FR-04.1: 쿠폰 생성 (관리자)
  - 관리자는 새로운 쿠폰을 생성할 수 있어야 함
  - 설정 항목: 쿠폰명, 할인 타입(정액/정률), 할인 금액/비율, 최소 주문 금액, 발급 가능 수량, 유효 기간
#### FR-04.2: 선착순 쿠폰 발급
  - 고객은 선착순으로 쿠폰을 발급받을 수 있어야 함
  - 발급 가능 수량 초과 시 발급 실패
  - 이미 발급받은 쿠폰은 재발급 불가
#### FR-04.3: 내 쿠폰 조회
  - 고객은 보유한 쿠폰 목록을 조회할 수 있어야 함
  - 사용 가능/사용 완료/만료 상태 구분 표시
  - 각 쿠폰의 할인 정보 및 유효기간 표시
#### FR-04.4: 쿠폰 유효성 검증
  - 주문 시 쿠폰의 유효성을 검증해야 함
  - 검증 항목: 유효기간, 사용 여부, 최소 주문 금액 충족 여부
  - 검증 실패 시 구체적인 사유 반환
#### FR-04.5: 쿠폰 사용 처리
  - 결제 완료 시 사용된 쿠폰은 사용 완료 상태로 변경
  - 사용일시 기록

### FR-05: 포인트 관리
#### FR-05.1: 포인트 충전
  - 고객은 자신의 포인트을 충전할 수 있어야 함
  - 충전 가능 단위: 1,000원
  - 1000원 이상부터 충전 가능
  - 충전 시 포인트 증가 및 충전 이력 기록
#### FR-05.2: 포인트 조회
  - 고객은 현재 포인트을 조회할 수 있어야 함
#### FR-05.3: 포인트 사용 이력 조회
  - 고객은 포인트 충전 및 사용 내역을 조회할 수 있어야 함
  - 이력 항목: 일시, 구분(충전/사용), 금액, 잔액

### FR-06: 데이터 연동
#### FR-06.1: 주문 데이터 외부 전송
  - 주문 완료 시 주문 정보를 외부 시스템에 전송해야 함
  - 전송 데이터: 주문번호, 고객정보, 주문 상품 목록, 결제 금액, 주문일시
#### FR-06.2: 전송 실패 시 재시도
  - 외부 전송 실패 시 자동으로 재시도해야 함
  - 최대 재시도 횟수: 3회
  - 재시도 간격: 1분, 5분, 15분
#### FR-06.3: 주문 정상 처리 보장
  - 외부 전송 실패와 무관하게 주문은 정상 처리되어야 함
  - 전송 실패 시에도 고객은 주문 완료 상태 확인 가능
#### FR-06.4: 전송 이력 관리
  - 모든 외부 전송 시도는 이력으로 기록되어야 함
  - 이력 항목: 전송 일시, 성공/실패 여부, 재시도 횟수

---

## 비기능적 요구사항 (Non-Functional Requirements)
###  NFR-01: 성능
#### NFR-01.1: 응답 시간
- 상품 조회 API 응답 시간: 평균 200ms 이내
- 주문 생성 API 응답 시간: 평균 500ms 이내
- 장바구니 조회 API 응답 시간: 평균 150ms 이내
#### NFR-01.2: 처리량
- 동시 사용자 1,000명 이상 처리 가능
- 선착순 쿠폰 발급 TPS: 1,000 이상
#### NFR-01.3: 데이터베이스 쿼리
- 단일 쿼리 응답 시간: 100ms 이내
- N+1 쿼리 문제 방지를 위한 최적화 적용

### NFR-02: 확장성
#### NFR-02.1: 수평 확장
- 애플리케이션 서버는 무상태(Stateless)로 설계
- 로드 밸런서를 통한 다중 인스턴스 운영 가능
#### NFR-02.2: 데이터베이스
- 읽기 전용 복제본 활용 가능한 구조
- 파티셔닝 적용 가능한 테이블 설계

### NFR-03: 가용성
#### NFR-03.1: 시스템 가동률
- 목표 가동률: 99.5% 이상
- 계획된 유지보수 시간 제외
#### NFR-03.2: 장애 복구
- 서비스 재시작 시간: 5분 이내
- 데이터 백업 주기: 일 1회

### NFR-04: 신뢰성
#### NFR-04.1: 데이터 정합성
- 재고 차감의 정합성 100% 보장
- 잔액 차감의 정합성 100% 보장
- 쿠폰 발급 수량 초과 방지
#### NFR-04.2: 트랜잭션 처리
- 주문 생성, 재고 차감, 결제는 하나의 트랜잭션으로 처리
- 트랜잭션 실패 시 자동 롤백
#### NFR-04.3: 외부 연동 안정성
- 외부 전송 실패가 주문 처리에 영향을 주지 않음

### NFR-05: 유지보수성
#### NFR-05.1: 코드 구조
- 계층형 아키텍처 적용 (Controller, Service, Repository)
- 도메인 중심 설계
#### NFR-05.2: 테스트
- 단위 테스트 작성 권장
- 핵심 비즈니스 로직 테스트 커버리지: 70% 이상
#### NFR-05.3: 로깅
- 주요 비즈니스 로직 실행 시 로그 기록
- 에러 발생 시 상세 스택 트레이스 기록
- 로그 레벨: DEBUG, INFO, WARN, ERROR
#### NFR-05.4: 문서화
- API 명세서 작성 (api-specification.md)
- 데이터 모델 문서 작성 (data-models.md)
- README 작성 (프로젝트 설정, 실행 방법)

### NFR-06: 사용성
#### NFR-06.1: API 설계
- RESTful API 원칙 준수
- 일관된 URI 네이밍 컨벤션
### NFR-06.2: 에러 처리
- 명확한 에러 메시지 제공
- HTTP 상태 코드 적절히 반환
- 에러 응답 형식 통일
### NFR-06.3: 응답 형식
- JSON 형식 사용
- 일관된 응답 구조
- 페이징 응답에 메타 정보 포함

---

## 제약사항

### 비즈니스 제약
- 최소 주문 금액: 1,000원
- 쿠폰은 주문당 1개만 적용
- 재고는 음수 불가
- 포인트는 음수 불가
- 포인트 충전은 1000원 이상부터 가능하며, 1000원 단위

---

## 기술 스택

### Backend
- Java 17
- Spring Boot 3.5.7
- Spring Data JPA
- MySQL 8.0
- JUnit 5
- Mockito
- Lombok

### Build Tool
- Gradle 8.5